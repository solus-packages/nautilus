From e3117fd063d1838300894e6397830e0aeb85204f Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Fri, 17 Sep 2021 22:20:49 +0300
Subject: [PATCH 6/9] Revert "window: Make bottom corners rounded"

This reverts commit 2451836f71a5d80a55115343908c8656c81c3367.
---
 src/nautilus-toolbar.c               |  2 +-
 src/nautilus-toolbar.h               |  3 +--
 src/nautilus-window.c                |  4 ++--
 src/nautilus-window.h                |  3 +--
 src/resources/ui/nautilus-toolbar.ui |  2 +-
 src/resources/ui/nautilus-window.ui  | 11 +++++------
 6 files changed, 11 insertions(+), 14 deletions(-)

diff --git a/src/nautilus-toolbar.c b/src/nautilus-toolbar.c
index dc5574a07..cae738a62 100644
--- a/src/nautilus-toolbar.c
+++ b/src/nautilus-toolbar.c
@@ -130,7 +130,7 @@ enum
 
 static GParamSpec *properties[NUM_PROPERTIES] = { NULL, };
 
-G_DEFINE_TYPE (NautilusToolbar, nautilus_toolbar, HDY_TYPE_HEADER_BAR);
+G_DEFINE_TYPE (NautilusToolbar, nautilus_toolbar, GTK_TYPE_HEADER_BAR);
 
 static void nautilus_toolbar_set_window_slot_real (NautilusToolbar    *self,
                                                    NautilusWindowSlot *slot);
diff --git a/src/nautilus-toolbar.h b/src/nautilus-toolbar.h
index 364bc76d8..13f00721e 100644
--- a/src/nautilus-toolbar.h
+++ b/src/nautilus-toolbar.h
@@ -24,7 +24,6 @@
 #pragma once
 
 #include <gtk/gtk.h>
-#include <libhandy-1/handy.h>
 
 #include "nautilus-window-slot.h"
 
@@ -32,7 +31,7 @@ G_BEGIN_DECLS
 
 #define NAUTILUS_TYPE_TOOLBAR nautilus_toolbar_get_type()
 
-G_DECLARE_FINAL_TYPE (NautilusToolbar, nautilus_toolbar, NAUTILUS, TOOLBAR, HdyHeaderBar)
+G_DECLARE_FINAL_TYPE (NautilusToolbar, nautilus_toolbar, NAUTILUS, TOOLBAR, GtkHeaderBar)
 
 GtkWidget *nautilus_toolbar_new (void);
 
diff --git a/src/nautilus-window.c b/src/nautilus-window.c
index 54566b94d..ce1100b0b 100644
--- a/src/nautilus-window.c
+++ b/src/nautilus-window.c
@@ -97,7 +97,7 @@ static void nautilus_window_back_or_forward (NautilusWindow *window,
 
 struct _NautilusWindow
 {
-    HdyApplicationWindow parent_instance;
+    GtkApplicationWindow parent_instance;
 
     GtkWidget *notebook;
 
@@ -162,7 +162,7 @@ enum
 
 static guint signals[LAST_SIGNAL] = { 0 };
 
-G_DEFINE_TYPE (NautilusWindow, nautilus_window, HDY_TYPE_APPLICATION_WINDOW);
+G_DEFINE_TYPE (NautilusWindow, nautilus_window, GTK_TYPE_APPLICATION_WINDOW);
 
 static const struct
 {
diff --git a/src/nautilus-window.h b/src/nautilus-window.h
index 5b9bf9133..cd967bd3a 100644
--- a/src/nautilus-window.h
+++ b/src/nautilus-window.h
@@ -27,14 +27,13 @@
 #pragma once
 
 #include <gtk/gtk.h>
-#include <libhandy-1/handy.h>
 
 #include "nautilus-types.h"
 
 G_BEGIN_DECLS
 
 #define NAUTILUS_TYPE_WINDOW (nautilus_window_get_type ())
-G_DECLARE_FINAL_TYPE (NautilusWindow, nautilus_window, NAUTILUS, WINDOW, HdyApplicationWindow);
+G_DECLARE_FINAL_TYPE (NautilusWindow, nautilus_window, NAUTILUS, WINDOW, GtkApplicationWindow);
 
 typedef gboolean (* NautilusWindowGoToCallback) (NautilusWindow *window,
                                                  GFile *location,
diff --git a/src/resources/ui/nautilus-toolbar.ui b/src/resources/ui/nautilus-toolbar.ui
index 4bf6e3621..51a882838 100644
--- a/src/resources/ui/nautilus-toolbar.ui
+++ b/src/resources/ui/nautilus-toolbar.ui
@@ -477,7 +477,7 @@
       </object>
     </child>
   </object>
-  <template class="NautilusToolbar" parent="HdyHeaderBar">
+  <template class="NautilusToolbar" parent="GtkHeaderBar">
     <property name="visible">True</property>
     <property name="can_focus">False</property>
     <property name="show_close_button">True</property>
diff --git a/src/resources/ui/nautilus-window.ui b/src/resources/ui/nautilus-window.ui
index e554696ca..8ce69c64f 100644
--- a/src/resources/ui/nautilus-window.ui
+++ b/src/resources/ui/nautilus-window.ui
@@ -1,15 +1,14 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <interface>
-  <template class="NautilusWindow" parent="HdyApplicationWindow">
+  <template class="NautilusWindow" parent="GtkApplicationWindow">
     <property name="show-menubar">False</property>
     <property name="title" translatable="yes">_Files</property>
+    <child type="titlebar">
+      <object class="NautilusToolbar" id="toolbar"/>
+    </child>
     <child>
-      <object class="GtkBox">
+      <object class="GtkGrid">
         <property name="visible">True</property>
-        <property name="orientation">vertical</property>
-        <child>
-          <object class="NautilusToolbar" id="toolbar"/>
-        </child>
         <child>
           <object class="GtkPaned" id="content_paned">
             <property name="visible">True</property>
-- 
2.32.0

